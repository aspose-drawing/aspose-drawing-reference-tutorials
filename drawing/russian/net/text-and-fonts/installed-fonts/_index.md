---
date: 2025-12-06
description: Узнайте, как сохранять PNG‑изображения, выводить список установленных
  шрифтов, показывать семейства шрифтов, создавать графику из растрового изображения
  и рисовать текст с помощью шрифтов, используя Aspose.Drawing для .NET.
linktitle: Save PNG Image and Work with Installed Fonts in Aspose.Drawing
second_title: Aspose.Drawing .NET API - Alternative to System.Drawing.Common
title: Сохранить PNG‑изображение и работать с установленными шрифтами в Aspose.Drawing
url: /ru/net/text-and-fonts/installed-fonts/
weight: 13
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Сохранить PNG‑изображение и работать с установленными шрифтами в Aspose.Drawing

## Введение

Если вам нужно **сохранить PNG‑изображения**, которые также отображают информацию о шрифтах, установленных на машине, Aspose.Drawing для .NET предоставляет чистый, кросс‑платформенный способ сделать это. В этом руководстве мы пройдемся по перечислению установленных шрифтов, отображению семейств шрифтов, созданию графики из bitmap и рисованию текста шрифтами — всё это с последующим сохранением результата в PNG‑файл. К концу вы получите переиспользуемый фрагмент кода, который можно вставить в любой .NET‑проект.

## Быстрые ответы
- **Что создаёт это руководство?** PNG‑изображение со списком установленных семейств шрифтов.  
- **Какая библиотека требуется?** Aspose.Drawing для .NET (System.Drawing.Common не нужен).  
- **Можно ли использовать пользовательские шрифты?** Да — просто загрузите их в `InstalledFontCollection`.  
- **Можно ли регулировать разрешение вывода?** Конечно — измените размер bitmap или формат пикселей.  
- **Нужна ли лицензия для выполнения кода?** Временная лицензия подходит для оценки; полная лицензия требуется для продакшна.

## Что означает «save PNG image» в контексте Aspose.Drawing?
Сохранение PNG‑изображения означает кодирование вашей поверхности рисования (объекта `Bitmap`) в файл с расширением `.png`. Aspose.Drawing берёт на себя процесс кодирования, поэтому вам достаточно вызвать `bitmap.Save(...)` с нужным путём.

## Почему стоит перечислять установленные шрифты и показывать их семейства?
Знание доступных шрифтов позволяет создавать динамическую графику, адаптирующуюся к окружению конечного пользователя. Это особенно полезно при генерации отчётов, сертификатов или любого визуального контента, который должен соответствовать фирменному стилю без необходимости поставлять файлы шрифтов.

## Предварительные требования

- **Библиотека Aspose.Drawing** — скачайте последнюю версию со [страницы загрузки Aspose Drawing](https://releases.aspose.com/drawing/net/).  
- **IDE** — Visual Studio, Rider или любой совместимый с .NET редактор.  
- **Базовые знания C#** — вы должны уверенно работать с классами, объектами и простыми циклами.

## Подключение пространств имён
Чтобы работать со шрифтами и графикой, подключите следующие пространства имён в начале вашего C#‑файла:

```csharp
using System.Drawing;
using System.Drawing.Text;
```

## Пошаговое руководство

### Шаг 1: Создать bitmap (полотно)
Сначала создаём bitmap, который будет хранить окончательное изображение. Размер bitmap и формат пикселей определяют качество сохраняемого PNG.

```csharp
Bitmap bitmap = new Bitmap(1000, 800, System.Drawing.Imaging.PixelFormat.Format32bppPArgb);
```

### Шаг 2: Создать graphics из bitmap
Далее получаем объект `Graphics` из bitmap. Этот объект позволяет рисовать фигуры, текст и изображения на полотне.

```csharp
Graphics graphics = Graphics.FromImage(bitmap);
graphics.TextRenderingHint = TextRenderingHint.AntiAliasGridFit;
graphics.Clear(Color.FromKnownColor(KnownColor.White));
```

### Шаг 3: Настроить кисть и шрифт (рисуем текст шрифтами)
Нужна кисть для цвета текста и объект `Font`, определяющий тип, размер и стиль шрифта.

```csharp
Brush brush = new SolidBrush(Color.FromKnownColor(KnownColor.Black));
InstalledFontCollection fonts = new InstalledFontCollection();
Font arial = new Font("Arial", 20, FontStyle.Regular);
```

### Шаг 4: Перечислить установленные шрифты и показать их семейства
Теперь выводим количество семейств шрифтов и несколько первых названий непосредственно на bitmap. Это демонстрирует возможности **list installed fonts** и **show font families**.

```csharp
graphics.DrawString(fonts.Families.Length + " installed font families.", arial, brush, 100, 100);

for (int i = 0; i < 6 && i < fonts.Families.Length; ++i)
{
    graphics.DrawString(fonts.Families[i].Name, arial, brush, 100, (i + 2) * 100);
}
```

### Шаг 5: Сохранить PNG‑изображение
Наконец, записываем bitmap на диск в виде PNG‑файла. Это основная операция **save png image**.

```csharp
bitmap.Save("Your Document Directory" + @"TextFonts\InstalledFonts_out.png");
```

> **Совет:** Используйте `Path.Combine` для построения путей к файлам, чтобы избежать проблем с разделителями каталогов на разных операционных системах.

## Распространённые проблемы и их решения
| Проблема | Причина | Решение |
|----------|----------|----------|
| **Шрифты не отображаются** | `InstalledFontCollection` не заполнен (например, запуск на безголовом сервере без шрифтов). | Установите необходимые шрифты на сервере или внедрите пользовательские шрифты в приложение. |
| **Сохранённый файл повреждён** | Неправильный формат пикселей или отсутствие прав записи. | Убедитесь, что целевая папка существует и приложение имеет права записи; сохраняйте в `Format32bppPArgb`. |
| **Текст выглядит размытым** | Низкие настройки DPI. | Увеличьте размеры bitmap или задайте `graphics.SmoothingMode = SmoothingMode.AntiAlias`. |

## Часто задаваемые вопросы

**В: Можно ли использовать пользовательские шрифты, которые не установлены на машине?**  
О: Да. Загрузите файл шрифта в `PrivateFontCollection` и создайте `Font` из этой коллекции.

**В: Как обрабатывать исключения, связанные со шрифтами?**  
О: Оберните создание шрифта в блок `try/catch` и проверяйте `ArgumentException` на отсутствие семейства.

**В: Подходит ли Aspose.Drawing для веб‑приложений?**  
О: Абсолютно. Библиотека работает в ASP.NET Core, Azure Functions и других серверных средах.

**В: Можно ли изменить цвет или стиль текста?**  
О: Да. Используйте разные типы `Brush` (например, `LinearGradientBrush`) и изменяйте перечисление `FontStyle`.

**В: Где получить временную лицензию для тестирования?**  
О: Скачайте пробную лицензию со [страницы временных лицензий Aspose](https://purchase.aspose.com/temporary-license/).

## Заключение

Следуя этим шагам, вы научились **save PNG image** файлы, которые динамически **list installed fonts**, **show font families**, **create graphics from bitmap** и **draw text with fonts** с помощью Aspose.Drawing для .NET. Экспериментируйте с другими шрифтами, цветами и размерами bitmap, чтобы подобрать оптимальный визуальный стиль для вашего проекта.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}

---

**Последнее обновление:** 2025-12-06  
**Тестировано с:** Aspose.Drawing 24.11 для .NET  
**Автор:** Aspose